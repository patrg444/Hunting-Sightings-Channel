{
  "version": 3,
  "sources": ["../../leaflet.heat/src/HeatLayer.js"],
  "sourcesContent": ["/*\n (c) 2014, Vladimir Agafonkin\n Leaflet.heat, a tiny and fast heatmap plugin for Leaflet.\n https://github.com/Leaflet/Leaflet.heat\n*/\n\nL.HeatLayer = (L.Layer ? L.Layer : L.Class).extend({\n\n    // options: {\n    //     minOpacity: 0.05,\n    //     maxZoom: 18,\n    //     radius: 25,\n    //     blur: 15,\n    //     max: 1.0\n    // },\n\n    initialize: function (latlngs, options) {\n        this._latlngs = latlngs;\n        L.setOptions(this, options);\n    },\n\n    setLatLngs: function (latlngs) {\n        this._latlngs = latlngs;\n        return this.redraw();\n    },\n\n    addLatLng: function (latlng) {\n        this._latlngs.push(latlng);\n        return this.redraw();\n    },\n\n    setOptions: function (options) {\n        L.setOptions(this, options);\n        if (this._heat) {\n            this._updateOptions();\n        }\n        return this.redraw();\n    },\n\n    redraw: function () {\n        if (this._heat && !this._frame && !this._map._animating) {\n            this._frame = L.Util.requestAnimFrame(this._redraw, this);\n        }\n        return this;\n    },\n\n    onAdd: function (map) {\n        this._map = map;\n\n        if (!this._canvas) {\n            this._initCanvas();\n        }\n\n        map._panes.overlayPane.appendChild(this._canvas);\n\n        map.on('moveend', this._reset, this);\n\n        if (map.options.zoomAnimation && L.Browser.any3d) {\n            map.on('zoomanim', this._animateZoom, this);\n        }\n\n        this._reset();\n    },\n\n    onRemove: function (map) {\n        map.getPanes().overlayPane.removeChild(this._canvas);\n\n        map.off('moveend', this._reset, this);\n\n        if (map.options.zoomAnimation) {\n            map.off('zoomanim', this._animateZoom, this);\n        }\n    },\n\n    addTo: function (map) {\n        map.addLayer(this);\n        return this;\n    },\n\n    _initCanvas: function () {\n        var canvas = this._canvas = L.DomUtil.create('canvas', 'leaflet-heatmap-layer leaflet-layer');\n\n        var originProp = L.DomUtil.testProp(['transformOrigin', 'WebkitTransformOrigin', 'msTransformOrigin']);\n        canvas.style[originProp] = '50% 50%';\n\n        var size = this._map.getSize();\n        canvas.width  = size.x;\n        canvas.height = size.y;\n\n        var animated = this._map.options.zoomAnimation && L.Browser.any3d;\n        L.DomUtil.addClass(canvas, 'leaflet-zoom-' + (animated ? 'animated' : 'hide'));\n\n        this._heat = simpleheat(canvas);\n        this._updateOptions();\n    },\n\n    _updateOptions: function () {\n        this._heat.radius(this.options.radius || this._heat.defaultRadius, this.options.blur);\n\n        if (this.options.gradient) {\n            this._heat.gradient(this.options.gradient);\n        }\n        if (this.options.max) {\n            this._heat.max(this.options.max);\n        }\n    },\n\n    _reset: function () {\n        var topLeft = this._map.containerPointToLayerPoint([0, 0]);\n        L.DomUtil.setPosition(this._canvas, topLeft);\n\n        var size = this._map.getSize();\n\n        if (this._heat._width !== size.x) {\n            this._canvas.width = this._heat._width  = size.x;\n        }\n        if (this._heat._height !== size.y) {\n            this._canvas.height = this._heat._height = size.y;\n        }\n\n        this._redraw();\n    },\n\n    _redraw: function () {\n        var data = [],\n            r = this._heat._r,\n            size = this._map.getSize(),\n            bounds = new L.Bounds(\n                L.point([-r, -r]),\n                size.add([r, r])),\n\n            max = this.options.max === undefined ? 1 : this.options.max,\n            maxZoom = this.options.maxZoom === undefined ? this._map.getMaxZoom() : this.options.maxZoom,\n            v = 1 / Math.pow(2, Math.max(0, Math.min(maxZoom - this._map.getZoom(), 12))),\n            cellSize = r / 2,\n            grid = [],\n            panePos = this._map._getMapPanePos(),\n            offsetX = panePos.x % cellSize,\n            offsetY = panePos.y % cellSize,\n            i, len, p, cell, x, y, j, len2, k;\n\n        // console.time('process');\n        for (i = 0, len = this._latlngs.length; i < len; i++) {\n            p = this._map.latLngToContainerPoint(this._latlngs[i]);\n            if (bounds.contains(p)) {\n                x = Math.floor((p.x - offsetX) / cellSize) + 2;\n                y = Math.floor((p.y - offsetY) / cellSize) + 2;\n\n                var alt =\n                    this._latlngs[i].alt !== undefined ? this._latlngs[i].alt :\n                    this._latlngs[i][2] !== undefined ? +this._latlngs[i][2] : 1;\n                k = alt * v;\n\n                grid[y] = grid[y] || [];\n                cell = grid[y][x];\n\n                if (!cell) {\n                    grid[y][x] = [p.x, p.y, k];\n\n                } else {\n                    cell[0] = (cell[0] * cell[2] + p.x * k) / (cell[2] + k); // x\n                    cell[1] = (cell[1] * cell[2] + p.y * k) / (cell[2] + k); // y\n                    cell[2] += k; // cumulated intensity value\n                }\n            }\n        }\n\n        for (i = 0, len = grid.length; i < len; i++) {\n            if (grid[i]) {\n                for (j = 0, len2 = grid[i].length; j < len2; j++) {\n                    cell = grid[i][j];\n                    if (cell) {\n                        data.push([\n                            Math.round(cell[0]),\n                            Math.round(cell[1]),\n                            Math.min(cell[2], max)\n                        ]);\n                    }\n                }\n            }\n        }\n        // console.timeEnd('process');\n\n        // console.time('draw ' + data.length);\n        this._heat.data(data).draw(this.options.minOpacity);\n        // console.timeEnd('draw ' + data.length);\n\n        this._frame = null;\n    },\n\n    _animateZoom: function (e) {\n        var scale = this._map.getZoomScale(e.zoom),\n            offset = this._map._getCenterOffset(e.center)._multiplyBy(-scale).subtract(this._map._getMapPanePos());\n\n        if (L.DomUtil.setTransform) {\n           L.DomUtil.setTransform(this._canvas, offset, scale);\n\n        } else {\n            this._canvas.style[L.DomUtil.TRANSFORM] = L.DomUtil.getTranslateString(offset) + ' scale(' + scale + ')';\n        }\n    }\n});\n\nL.heatLayer = function (latlngs, options) {\n    return new L.HeatLayer(latlngs, options);\n};\n"],
  "mappings": "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",
  "names": []
}
